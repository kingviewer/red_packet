(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["room"],{3686:function(t,i,e){"use strict";e("fba5")},"99af":function(t,i,e){"use strict";var s=e("23e7"),n=e("da84"),a=e("d039"),o=e("e8b5"),c=e("861d"),r=e("7b0b"),u=e("07fa"),d=e("8418"),f=e("65f0"),l=e("1dde"),h=e("b622"),p=e("2d00"),_=h("isConcatSpreadable"),m=9007199254740991,g="Maximum allowed index exceeded",v=n.TypeError,b=p>=51||!a((function(){var t=[];return t[_]=!1,t.concat()[0]!==t})),w=l("concat"),j=function(t){if(!c(t))return!1;var i=t[_];return void 0!==i?!!i:o(t)},k=!b||!w;s({target:"Array",proto:!0,forced:k},{concat:function(t){var i,e,s,n,a,o=r(this),c=f(o,0),l=0;for(i=-1,s=arguments.length;i<s;i++)if(a=-1===i?o:arguments[i],j(a)){if(n=u(a),l+n>m)throw v(g);for(e=0;e<n;e++,l++)e in a&&d(c,l,a[e])}else{if(l>=m)throw v(g);d(c,l++,a)}return c.length=l,c}})},ba72:function(t,i,e){"use strict";e.d(i,"h",(function(){return n})),e.d(i,"f",(function(){return a})),e.d(i,"j",(function(){return o})),e.d(i,"g",(function(){return c})),e.d(i,"i",(function(){return r})),e.d(i,"b",(function(){return u})),e.d(i,"n",(function(){return d})),e.d(i,"k",(function(){return f})),e.d(i,"c",(function(){return l})),e.d(i,"m",(function(){return h})),e.d(i,"l",(function(){return p})),e.d(i,"a",(function(){return _})),e.d(i,"d",(function(){return m})),e.d(i,"e",(function(){return g}));var s=e("b775"),n=function(t){return Object(s["a"])("/games/list_all",t)},a=function(t){return Object(s["a"])("/games/info",t)},o=function(t){return Object(s["a"])("/games/list_waiters",t)},c=function(t){return Object(s["b"])("/games/join",t)},r=function(t){return Object(s["a"])("/user_game_rounds/list_my",t)},u=function(t){return Object(s["b"])("/game_rooms/create",t)},d=function(t){return Object(s["a"])("/game_rooms/search",t)},f=function(t){return Object(s["a"])("/game_rooms/query",t)},l=function(t){return Object(s["b"])("/game_rooms/join",t)},h=function(t){return Object(s["a"])("/game_rooms/list_users",t)},p=function(t){return Object(s["a"])("/game_rounds/list_by_room",t)},_=function(t){return Object(s["a"])("/game_rooms/entered_room",t)},m=function(t){return Object(s["b"])("/game_rooms/leave",t)},g=function(t){return Object(s["a"])("/game_rounds/info",t)}},c0a4:function(t,i,e){t.exports=e.p+"static/img/PK.bed7a3a8.gif"},ce76:function(t,i,e){"use strict";e.r(i);var s=function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("div",{staticClass:"beijinTY"},[s("div",{staticClass:"box"},[s("img",{staticClass:"goback",attrs:{src:e("5450"),alt:""},on:{click:function(i){return t.onClickLeft()}}}),t._m(0)]),s("ul",{staticClass:"marT50 listul"},[s("li",{staticClass:"listLi"},[s("div",{staticClass:"jilu"},[s("div",{staticClass:"jilutext clearfix"},[s("div",{staticClass:"fl"},[s("p",[t._v("PK数额 "+t._s(t.info.usdt_amount))]),s("p",[t._v("满员人数 "+t._s(t.info.player_amount))])]),s("div",{staticClass:"fr"},["大厅"!=this.type?s("p",[t._v("最低账户余额 "+t._s(t.info.usdt_amount))]):t._e(),s("p",[t._v("PK成功人数 "+t._s(t.info.player_amount-t.info.loser_amount))])])]),"大厅"==t.type||"加入"==t.type?s("div",[s("div",{staticClass:"canyupk",on:{click:function(i){return t.gotoPK()}}},[t._v("参与PK")])]):s("div",{staticClass:"roomid"},[t._v("房间ID："+t._s(t.id))])])])]),s("ul",{staticClass:"clearfix margintop30"},t._l(t.waiterlist,(function(i){return s("li",{key:i.id,staticClass:"fl renyuan"},[s("img",{staticClass:"avatar",attrs:{src:e("4d41"),alt:""}}),s("div",{staticClass:"textstyle"},[t._v("ID:"+t._s(i.invite_code))])])})),0),s("van-popup",{model:{value:t.popupshow,callback:function(i){t.popupshow=i},expression:"popupshow"}},[s("div",{staticClass:"yaoqingbg"},[s("h1",{staticClass:"yaoqingtitle"},[t._v("PK进行中")]),s("img",{staticClass:"pkzhong",attrs:{src:e("c0a4"),alt:""}})])]),s("van-popup",{model:{value:t.PKshow,callback:function(i){t.PKshow=i},expression:"PKshow"}},[s("div",{staticClass:"PKyaoqingbg"},[s("div",{staticClass:"PKyaoqingbg"},[s("h1",{staticClass:"PKyaoqingtitle"},[t._v("PK"+t._s(t.pkshowText))]),"失败"==t.pkshowText?s("div",{staticClass:"PKcopy_text"},[s("p",{staticClass:"yihang"},[t._v("很遗憾！")]),s("p",[t._v("但您仍获得了一把绳子")])]):t._e(),"成功"==t.pkshowText?s("div",{staticClass:"PKcopy_text"},[s("p",[t._v("恭喜获得"+t._s(t.usdt_won)+"GTF")])]):t._e(),s("div",{staticClass:"PKbtnline"},[s("div",{staticClass:"fuzhi",on:{click:function(i){return t.PKshowclick()}}},[t._v("确定")])])])])])],1)},n=[function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"daohanlan"},[e("p",{staticClass:"text"},[t._v("PK竞技场")])])}],a=e("5530"),o=(e("99af"),e("4de4"),e("d3b7"),e("ba72")),c={data:function(){return{popupshow:!1,PKshow:!1,id:"",info:"",waiterlist:[],type:"",path:"ws://54.193.133.101:3000/cable",socket:"",pkshowText:"",usdt_won:""}},mounted:function(){this.id=this.$route.query.id,this.type=this.$route.query.type,this.gamesinfo(),this.gameslist_waiter(),this.init()},watch:function(){},methods:{onClickLeft:function(){if(this.$router.go(-1),this.socket.onclose=this.close,"大厅"!=this.type){var t=Object(a["a"])({id:this.id},this.$datapublic);Object(o["d"])(t).then((function(t){console.log("离开")})).catch((function(t){reject(t)}))}},PKshowclick:function(){this.PKshow=!1,this.$router.push({path:"/arena"})},init:function(){"undefined"===typeof WebSocket?alert("您的浏览器不支持socket"):(this.socket=new WebSocket(this.path),this.socket.onopen=this.open,this.socket.onerror=this.error,this.socket.onmessage=this.getMessage)},open:function(){console.log("socket连接成功")},error:function(){console.log("连接错误")},getMessage:function(t){var i=this;if(console.log(t.data),this.id==t.data.id){if("join"==t.data.action){var e={invite_code:t.data.invite_code};this.waiterlist=this.waiterlist.concat([e])}if("win"==t.data.action){this.popupshow=!0;var s=this;setTimeout((function(){Object(o["e"])().then((function(t){"success"==t.data.code?(s.popupshow=!1,t.data.data.loser?(s.PKshow=!0,s.pkshowText="失败"):(s.PKshow=!0,s.pkshowText="成功",s.usdt_won=t.data.data.usdt_won)):i.$toast(t.data.msg)})).catch((function(t){reject(t)}))}),3e3)}if("leave"==t.data.action){var n=this.waiterlist.filter((function(i){return i.invite_code!=t.data.invite_code}));this.waiterlist=n}}},send:function(){var t="";t="大厅"==this.type?"game_"+this.id:"game_room_"+this.id,this.socket.send(t)},close:function(){console.log("socket已经关闭")},gamesinfo:function(){var t=this,i={id:this.id};"大厅"==this.type?Object(o["f"])(i).then((function(i){"success"==i.data.code?t.info=i.data.data:t.$toast(i.data.msg)})).catch((function(t){reject(t)})):Object(o["k"])(i).then((function(i){"success"==i.data.code?t.info=i.data.data:t.$toast(i.data.msg)})).catch((function(t){reject(t)}))},gameslist_waiter:function(){var t=this,i={id:this.id};"大厅"==this.type?Object(o["j"])(i).then((function(i){"success"==i.data.code?t.waiterlist=i.data.data:t.$toast(i.data.msg)})).catch((function(t){reject(t)})):Object(o["m"])(i).then((function(i){"success"==i.data.code?t.waiterlist=i.data.data:t.$toast(i.data.msg)})).catch((function(t){reject(t)}))},gotoPK:function(){var t=this,i=Object(a["a"])({id:this.id},this.$datapublic);"大厅"==this.type?Object(o["g"])(i).then((function(i){"success"==i.data.code?t.gameslist_waiter():t.$toast(i.data.msg)})).catch((function(t){reject(t)})):Object(o["c"])(i).then((function(i){"success"==i.data.code?t.gameslist_waiter():t.$toast(i.data.msg)})).catch((function(t){reject(t)}))}}},r=c,u=(e("3686"),e("2877")),d=Object(u["a"])(r,s,n,!1,null,"7e108e22",null);i["default"]=d.exports},fba5:function(t,i,e){}}]);
//# sourceMappingURL=room.93bcacbb.js.map