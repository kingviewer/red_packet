(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["room"],{"7a83":function(t,i,n){},"99af":function(t,i,n){"use strict";var e=n("23e7"),s=n("da84"),a=n("d039"),o=n("e8b5"),c=n("861d"),r=n("7b0b"),u=n("07fa"),f=n("8418"),l=n("65f0"),d=n("1dde"),h=n("b622"),p=n("2d00"),_=h("isConcatSpreadable"),v=9007199254740991,m="Maximum allowed index exceeded",b=s.TypeError,g=p>=51||!a((function(){var t=[];return t[_]=!1,t.concat()[0]!==t})),w=d("concat"),j=function(t){if(!c(t))return!1;var i=t[_];return void 0!==i?!!i:o(t)},k=!g||!w;e({target:"Array",proto:!0,forced:k},{concat:function(t){var i,n,e,s,a,o=r(this),c=l(o,0),d=0;for(i=-1,e=arguments.length;i<e;i++)if(a=-1===i?o:arguments[i],j(a)){if(s=u(a),d+s>v)throw b(m);for(n=0;n<s;n++,d++)n in a&&f(c,d,a[n])}else{if(d>=v)throw b(m);f(c,d++,a)}return c.length=d,c}})},ba72:function(t,i,n){"use strict";n.d(i,"h",(function(){return s})),n.d(i,"f",(function(){return a})),n.d(i,"j",(function(){return o})),n.d(i,"g",(function(){return c})),n.d(i,"i",(function(){return r})),n.d(i,"b",(function(){return u})),n.d(i,"n",(function(){return f})),n.d(i,"k",(function(){return l})),n.d(i,"c",(function(){return d})),n.d(i,"m",(function(){return h})),n.d(i,"l",(function(){return p})),n.d(i,"a",(function(){return _})),n.d(i,"d",(function(){return v})),n.d(i,"e",(function(){return m}));var e=n("b775"),s=function(t){return Object(e["a"])("/games/list_all",t)},a=function(t){return Object(e["a"])("/games/info",t)},o=function(t){return Object(e["a"])("/games/list_waiters",t)},c=function(t){return Object(e["b"])("/games/join",t)},r=function(t){return Object(e["a"])("/user_game_rounds/list_my",t)},u=function(t){return Object(e["b"])("/game_rooms/create",t)},f=function(t){return Object(e["a"])("/game_rooms/search",t)},l=function(t){return Object(e["a"])("/game_rooms/query",t)},d=function(t){return Object(e["b"])("/game_rooms/join",t)},h=function(t){return Object(e["a"])("/game_rooms/list_users",t)},p=function(t){return Object(e["a"])("/game_rounds/list_by_room",t)},_=function(t){return Object(e["a"])("/game_rooms/entered_room",t)},v=function(t){return Object(e["b"])("/game_rooms/leave",t)},m=function(t){return Object(e["a"])("/game_rounds/info",t)}},c0a4:function(t,i,n){t.exports=n.p+"static/img/PK.bed7a3a8.gif"},ce76:function(t,i,n){"use strict";n.r(i);var e=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"beijinTY"},[e("div",{staticClass:"box"},[e("img",{staticClass:"goback",attrs:{src:n("5450"),alt:""},on:{click:function(i){return t.onClickLeft()}}}),t._m(0)]),e("ul",{staticClass:"marT50 listul"},[e("li",{staticClass:"listLi"},[e("div",{staticClass:"jilu"},[e("div",{staticClass:"jilutext clearfix"},[e("div",{staticClass:"fl"},[e("p",[t._v("PK数额 "+t._s(t.info.usdt_amount))]),e("p",[t._v("满员人数 "+t._s(t.info.player_amount))])]),e("div",{staticClass:"fr"},["大厅"!=this.type?e("p",[t._v("最低账户余额 "+t._s(t.info.usdt_amount))]):t._e(),e("p",[t._v("PK成功人数 "+t._s(t.info.player_amount-t.info.loser_amount))])])]),"大厅"==t.type||"加入"==t.type?e("div",[e("div",{staticClass:"canyupk",on:{click:function(i){return t.gotoPK()}}},[t._v("参与PK")])]):e("div",{staticClass:"roomid"},[t._v("房间ID："+t._s(t.id))])])])]),e("ul",{staticClass:"clearfix margintop30"},t._l(t.waiterlist,(function(i){return e("li",{key:i.id,staticClass:"fl renyuan"},[e("img",{staticClass:"avatar",attrs:{src:n("4d41"),alt:""}}),e("div",{staticClass:"textstyle"},[t._v("ID:"+t._s(i.invite_code))])])})),0),e("van-popup",{model:{value:t.popupshow,callback:function(i){t.popupshow=i},expression:"popupshow"}},[e("div",{staticClass:"yaoqingbg"},[e("h1",{staticClass:"yaoqingtitle"},[t._v("PK进行中")]),e("img",{staticClass:"pkzhong",attrs:{src:n("c0a4"),alt:""}})])]),e("van-popup",{model:{value:t.PKshow,callback:function(i){t.PKshow=i},expression:"PKshow"}},[e("div",{staticClass:"PKyaoqingbg"},[e("div",{staticClass:"PKyaoqingbg"},[e("h1",{staticClass:"PKyaoqingtitle"},[t._v("PK"+t._s(t.pkshowText))]),"失败"==t.pkshowText?e("div",{staticClass:"PKcopy_text"},[e("p",{staticClass:"yihang"},[t._v("很遗憾！")]),e("p",[t._v("但您仍获得了一把绳子")])]):t._e(),"成功"==t.pkshowText?e("div",{staticClass:"PKcopy_text"},[e("p",[t._v("恭喜获得"+t._s(t.usdt_won)+"GTF")])]):t._e(),e("div",{staticClass:"PKbtnline"},[e("div",{staticClass:"fuzhi",on:{click:function(i){return t.PKshowclick()}}},[t._v("确定")])])])])])],1)},s=[function(){var t=this,i=t.$createElement,n=t._self._c||i;return n("div",{staticClass:"daohanlan"},[n("p",{staticClass:"text"},[t._v("PK竞技场")])])}],a=n("5530"),o=(n("99af"),n("4de4"),n("d3b7"),n("ba72")),c={data:function(){return{popupshow:!1,PKshow:!1,id:"",info:"",waiterlist:[],type:"",path:"ws://54.193.133.101:3000/cable",socket:"",pkshowText:"",usdt_won:""}},mounted:function(){this.id=this.$route.query.id,this.type=this.$route.query.type,this.gamesinfo(),this.gameslist_waiter(),this.init()},watch:function(){},methods:{onClickLeft:function(){if(this.$router.go(-1),this.socket.onclose=this.close,"大厅"!=this.type){var t=Object(a["a"])({id:this.id},this.$datapublic);Object(o["d"])(t).then((function(t){console.log("离开")})).catch((function(t){reject(t)}))}},PKshowclick:function(){this.PKshow=!1,this.$router.push({path:"/arena"})},init:function(){"undefined"===typeof WebSocket?alert("您的浏览器不支持socket"):(this.socket=new WebSocket(this.path),this.socket.onopen=this.open,this.socket.onerror=this.error,this.socket.onmessage=this.getMessage)},open:function(){console.log("socket连接成功")},error:function(){console.log("连接错误")},getMessage:function(t){if(console.log(t.data),this.id==t.data.id){if("join"==t.data.action){var i={invite_code:t.data.invite_code};this.waiterlist=this.waiterlist.concat([i])}if("win"==t.data.action){this.popupshow=!0;var n=this;setTimeout((function(){Object(o["e"])().then((function(t){n.popupshow=!1,t.data.data.loser?(n.PKshow=!0,n.pkshowText="失败"):(n.PKshow=!0,n.pkshowText="成功",n.usdt_won=t.data.data.usdt_won)})).catch((function(t){reject(t)}))}),3e3)}if("leave"==t.data.action){var e=this.waiterlist.filter((function(i){return i.invite_code!=t.data.invite_code}));this.waiterlist=e}}},send:function(){var t="";t="大厅"==this.type?"game_"+this.id:"game_room_"+this.id,this.socket.send(t)},close:function(){console.log("socket已经关闭")},gamesinfo:function(){var t=this,i={id:this.id};"大厅"==this.type?Object(o["f"])(i).then((function(i){t.info=i.data.data})).catch((function(t){reject(t)})):Object(o["k"])(i).then((function(i){t.info=i.data.data})).catch((function(t){reject(t)}))},gameslist_waiter:function(){var t=this,i={id:this.id};"大厅"==this.type?Object(o["j"])(i).then((function(i){t.waiterlist=i.data.data})).catch((function(t){reject(t)})):Object(o["m"])(i).then((function(i){t.waiterlist=i.data.data})).catch((function(t){reject(t)}))},gotoPK:function(){var t=this,i=Object(a["a"])({id:this.id},this.$datapublic);"大厅"==this.type?Object(o["g"])(i).then((function(i){t.gameslist_waiter()})).catch((function(t){reject(t)})):Object(o["c"])(i).then((function(i){t.gameslist_waiter()})).catch((function(t){reject(t)}))}}},r=c,u=(n("cef0"),n("2877")),f=Object(u["a"])(r,e,s,!1,null,"78b23ac0",null);i["default"]=f.exports},cef0:function(t,i,n){"use strict";n("7a83")}}]);
//# sourceMappingURL=room.3535334d.js.map