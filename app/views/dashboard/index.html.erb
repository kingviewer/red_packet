<div class="main">
  <div id="red_packets" class="hidden">
    <%= render 'dashboard/index/red_packets' %>
  </div>
  <div id="friends" class="hidden">
    <%= render 'dashboard/index/friends' %>
  </div>
  <div id="assets" class="hidden">
    <%= render 'dashboard/index/assets' %>
  </div>
  <div id="settings" class="hidden">
    <%= render 'dashboard/index/settings' %>
  </div>
</div>

<script>
    function set_tab() {
        let tab_id;
        <% unless params[:tab].blank? %>
        tab_id = '<%= params[:tab].strip %>';
        <% end %>
        if (!tab_id)
            tab_id = localStorage.getItem('mobile:dashboard:tab');
        if (!tab_id)
            tab_id = TAB_IDS[0];
        change_main_tab(tab_id);
    }

    $(function () {
        alert('111111111111');
        getWeb3().then(res => {
            alert('2222222222222');
            web3 = res;
            contract_usdt = new web3.eth.Contract(Contracts.usdt.abi, Contracts.usdt.address);
            contract_cic = new web3.eth.Contract(Contracts.cic.abi, Contracts.cic.address);
            contract_game = new web3.eth.Contract(Contracts.game.abi, Contracts.game.address);
            web3.eth.getAccounts(function (err, result) {
                address = result[0];
                set_tab();
            });
        }).catch(function (result) {
            alert('33333333333333');
            console.log(result);
            swal('<%= t('errors.error') %>', result, 'error');
        });
    });
</script>